<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout.html(title=#{server.title}, selected='servers')}">
    <head>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.0/font/bootstrap-icons.css">
    </head>
    <body>
        <nav layout:fragment="breadcrumbs">
            <ul>
                <li>
                    <a th:href="@{/}" th:text="#{home.home}">Startseite</a>
                </li>
                <li>
                    <a th:href="@{/servers}" th:text="#{server.title}">Server-Ãœbersicht</a>
                </li>
                <li>
                    <a aria-current="location" th:href="@{/server(id=${server.id})}" th:text="${server.getName()}">Server</a>
                </li>
            </ul>
        </nav>
        <main layout:fragment="content">
            <h2 th:text="${server.getName()}" class="sub-heading">Server</h2>
            <ul class="flex table-bar">

            </ul>

            <table>
                <tr>
                    <th th:text="#{server.name}" scope="row">Servername</th>
                    <td th:text="${server.getName()}">Name</td>
                </tr>
            </table>

            <script>
                function toggleTable(string) {
                    let lTable1 = document.getElementById(string);
                    for (let i = 1; i < lTable1.rows.length; i++) {
                        lTable1.rows[i].style.display = (lTable1.rows[i].style.display === "none") ? "table-row" : "none";
                    }
                }
            </script>

            <table id="roleTable">
                <tr>
                    <th th:text="#{server.roles}" scope="row" id="loginLink1" onclick="toggleTable('roleTable');" href="#">Serverrollen</th>
                    <th th:text="#{server.role.type}" scope="row">Name</th>
                </tr>
                <tr th:name="roles" th:each="role : ${roles}" style="display: none">
                    <td th:text="${role.name}"></td>
                    <td>
                        <select id="roleType" name="roleType" th:onchange="'window.location.href = \'' + @{/changeRoleType} + '/\' + this.value + \'/' + ${role.getIdLong()} + '/' + ${server.getIdLong()} + '\''">
                            <option th:each="roleType : ${T(serverbot.role.RoleType).values()}" th:value="${roleType}" th:text="#{'role.type.' + ${roleType}}" th:selected="((${rolemanagement.findByRoleId(role.id).get().getRoleType()} == ${roleType}) ? selected)">
                        </select>
                    </td>
                </tr>
            </table>

            <script type="text/javascript" th:inline="javascript">
                var message = /*[[${rolesShown}]]*/ 'false';
                if (message === true) {
                    toggleTable('roleTable')
                }
            </script>

            <table id="channelTable">
                <tr>
                    <th th:text="#{server.channels}" scope="row" id="loginLink2" onclick="toggleTable('channelTable');" href="#">Serverrollen</th>
                    <th th:text="#{server.channel.type}" scope="row">Name</th>
                </tr>
                <tr th:name="channels" th:each="channel : ${channels}" style="display: none">
                    <td th:text="${channel.name}"></td>
                    <td>
                        <select id="channelType" name="channelType" th:onchange="'window.location.href = \'' + @{/changeChannelType} + '/\' + this.value + \'/' + ${channel.getIdLong()} + '/' + ${server.getIdLong()} + '\''">
                            <option th:each="channelType : ${T(serverbot.channel.ChannelType).values()}" th:value="${channelType}" th:text="#{'channel.type.' + ${channelType}}" th:selected="((${channelManagement.findByChannelId(channel.id).get().getChannelType()} == ${channelType}) ? selected)">
                        </select>
                    </td>
                </tr>
            </table>
            <script type="text/javascript" th:inline="javascript">
                var message = /*[[${channelsShown}]]*/ 'false';
                if (message === true) {
                    toggleTable('channelTable')
                }
            </script>
        </main>
    </body>
</html>
